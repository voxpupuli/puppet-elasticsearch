<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Defined Type: elasticsearch::plugin
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_defined_types::elasticsearch::plugin";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_defined_type_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (e)</a> &raquo;
    <span class='title'><span class='object_link'>Defined Types</span></span>
     &raquo; 
    <span class="title">elasticsearch::plugin</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Defined Type: elasticsearch::plugin</h1>
<div class="box_info">
  <dl>
    <dt>Defined in:</dt>
    <dd>
      manifests/plugin.pp
    </dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    
<p>This define allows you to install arbitrary Elasticsearch plugins either by
using the default repositories or by specifying an URL</p>

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>install from official repository</p>
</div></p>
      
      <pre class="example code"><code>elasticsearch::plugin {&#39;mobz/elasticsearch-head&#39;: module_dir =&gt; &#39;head&#39;}</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>installation using a custom URL</p>
</div></p>
      
      <pre class="example code"><code>elasticsearch::plugin { &#39;elasticsearch-jetty&#39;:
 module_dir =&gt; &#39;elasticsearch-jetty&#39;,
 url        =&gt; &#39;https://oss-es-plugins.s3.amazonaws.com/elasticsearch-jetty/elasticsearch-jetty-0.90.0.zip&#39;,
}</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ensure</span>
      
      
        <span class='type'>(<tt>Enum['absent', 'present']</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;present&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether the plugin will be installed or removed. Set to &#39;absent&#39; to
ensure a plugin is not installed</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>configdir</span>
      
      
        <span class='type'>(<tt>Stdlib::Absolutepath</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>$elasticsearch::configdir</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to the elasticsearch configuration directory (ES_PATH_CONF) to which
the plugin should be installed.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>instances</span>
      
      
        <span class='type'>(<tt>Variant[String, Array[String]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Specify all the instances related</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>java_opts</span>
      
      
        <span class='type'>(<tt>Array[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Array of Java options to be passed to <code>ES_JAVA_OPTS</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>java_home</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::Absolutepath]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Path to JAVA_HOME, if Java is installed in a non-standard location.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>module_dir</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Directory name where the module has been installed This is automatically
generated based on the module name Specify a value here to override the
auto generated value</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>proxy_host</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Proxy host to use when installing the plugin</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>proxy_password</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Proxy auth password to use when installing the plugin</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>proxy_port</span>
      
      
        <span class='type'>(<tt>Optional[Integer[0, 65535]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Proxy port to use when installing the plugin</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>proxy_username</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Proxy auth username to use when installing the plugin</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>source</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Specify the source of the plugin. This will copy over the plugin to the
node and use it for installation. Useful for offline installation</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::HTTPUrl]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Specify an URL where to download the plugin from.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Author:</p>
<ul class="author">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>Richard Pijnenburg <a
href="mailto:richard.pijnenburg@elasticsearch.com">richard.pijnenburg@elasticsearch.com</a></p>
</div>
      
    </li>
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>Matteo Sessa <a
href="mailto:matteo.sessa@catchoftheday.com.au">matteo.sessa@catchoftheday.com.au</a></p>
</div>
      
    </li>
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>Dennis Konert <a href="mailto:dkonert@gmail.com">dkonert@gmail.com</a></p>
</div>
      
    </li>
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>Tyler Langlois <a
href="mailto:tyler.langlois@elastic.co">tyler.langlois@elastic.co</a></p>
</div>
      
    </li>
  
</ul>

</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'manifests/plugin.pp', line 60</span>

define elasticsearch::plugin (
  Enum[&#39;absent&#39;, &#39;present&#39;]      $ensure         = &#39;present&#39;,
  Stdlib::Absolutepath           $configdir      = $elasticsearch::configdir,
  Variant[String, Array[String]] $instances      = [],
  Array[String]                  $java_opts      = [],
  Optional[Stdlib::Absolutepath] $java_home      = undef,
  Optional[String]               $module_dir     = undef,
  Optional[String]               $proxy_host     = undef,
  Optional[String]               $proxy_password = undef,
  Optional[Integer[0, 65535]]    $proxy_port     = undef,
  Optional[String]               $proxy_username = undef,
  Optional[String]               $source         = undef,
  Optional[Stdlib::HTTPUrl]      $url            = undef,
) {

  include elasticsearch

  case $ensure {
    &#39;present&#39;: {
      if empty($instances) and $elasticsearch::restart_plugin_change {
        fail(&#39;no $instances defined, even though `restart_plugin_change` is set!&#39;)
      }

      $_file_ensure = &#39;directory&#39;
      $_file_before = []
    }
    &#39;absent&#39;: {
      $_file_ensure = $ensure
      $_file_before = File[$elasticsearch::plugindir]
    }
    default: { }
  }

  if ! empty($instances) and $elasticsearch::restart_plugin_change {
    Elasticsearch_plugin[$name] {
      notify +&gt; Elasticsearch::Instance[$instances],
    }
  }

  # set proxy by override or parse and use proxy_url from
  # elasticsearch::proxy_url or use no proxy at all

  if ($proxy_host != undef and $proxy_port != undef) {
    if ($proxy_username != undef and $proxy_password != undef) {
      $_proxy_auth = &quot;${proxy_username}:${proxy_password}@&quot;
    } else {
      $_proxy_auth = undef
    }
    $_proxy = &quot;http://${_proxy_auth}${proxy_host}:${proxy_port}&quot;
  } elsif ($elasticsearch::proxy_url != undef) {
    $_proxy = $elasticsearch::proxy_url
  } else {
    $_proxy = undef
  }

  if ($source != undef) {

    $filename_array = split($source, &#39;/&#39;)
    $basefilename = $filename_array[-1]

    $file_source = &quot;${elasticsearch::package_dir}/${basefilename}&quot;

    file { $file_source:
      ensure =&gt; &#39;file&#39;,
      source =&gt; $source,
      before =&gt; Elasticsearch_plugin[$name],
    }

  } else {
    $file_source = undef
  }

  $_module_dir = es_plugin_name($module_dir, $name)

  elasticsearch_plugin { $name:
    ensure                     =&gt; $ensure,
    configdir                  =&gt; $configdir,
    elasticsearch_package_name =&gt; $elasticsearch::package_name,
    java_opts                  =&gt; $java_opts,
    java_home                  =&gt; $java_home,
    source                     =&gt; $file_source,
    url                        =&gt; $url,
    proxy                      =&gt; $_proxy,
    plugin_dir                 =&gt; $::elasticsearch::plugindir,
    plugin_path                =&gt; $module_dir,
  }
  -&gt; file { &quot;${elasticsearch::plugindir}/${_module_dir}&quot;:
    ensure  =&gt; $_file_ensure,
    mode    =&gt; &#39;o+Xr&#39;,
    recurse =&gt; true,
    before  =&gt; $_file_before,
  }
}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>